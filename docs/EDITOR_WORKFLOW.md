# 에디터 작업 흐름 (운영 대시보드 기준)

운영자는 `/admin` 영역을 사용해 정책/사건을 관리합니다. 현재는 개발 단계라 누구나 접근 가능하지만, URL은 내부 인원만 사용해야 합니다.

## 1. 주요 화면

1. `/admin/new` – 새 글 작성 폼 + 실시간 미리보기
2. `/admin/list` – 최근 20개의 등록 문서 확인, 보기/삭제 버튼 제공
3. `/admin/edit/:id` – 특정 문서 상세와 향후 수정 기능 초안 (아직 PUT 전송은 미구현)

> ⚠️ 지금은 인증이 비활성 상태입니다. 배포 링크를 외부에 공유하지 마세요.

## 2. 작성 절차 ( `/admin/new` )

1. **기본 정보 입력**
   - 제목, 날짜, 카테고리, 홈 카드 요약을 채웁니다.
2. **배경/맥락 작성**
   - 정책/사건이 무엇인지, 공식적으로 확인된 사실 위주로 정리합니다.
3. **핵심 bullet 입력**
   - 줄바꿈으로 구분된 bullet을 최소 1개 이상 작성합니다.
4. **진보/보수 시각 (선택)**
   - headline과 bullet이 모두 비어 있으면 해당 섹션은 저장되지 않습니다.
   - 주장 강도(intensity)는 0~100 사이 숫자이며 비워두면 제외됩니다.
5. **이게 내 삶에 뭐가 변함? (선택)**
   - 중립적 해석을 요약합니다. note 문구는 자동으로 `(ChatGPT의 의견)`을 포함합니다.
6. **출처 입력**
   - 각 줄을 `type|channelName|sourceDate|timestamp|note` 형식으로 입력합니다.
   - timestamp가 없으면 비워두고 `||`로 넘겨도 됩니다. 최소 1개 이상 필수입니다.
7. **등록 버튼 클릭**
   - `POST /api/issues`로 전송되며, 성공 시 로컬 draft가 초기화됩니다.

> 폼 입력 내용은 자동으로 `localStorage('adminDraftV2')`에 저장됩니다.

## 3. 목록/삭제 ( `/admin/list` )

- 화면 진입 시 `GET /api/issues`로 최근 20건을 불러옵니다.
- “보기 / 수정”을 누르면 `/admin/edit/:id`로 이동합니다.
- “삭제”를 누르면 `DELETE /api/issues/:id` 요청이 즉시 실행되어 Firestore와 metrics 문서 모두 제거됩니다. 되돌릴 수 없으니 주의합니다.

## 4. 수정 준비 ( `/admin/edit/:id` )

- 현재 저장된 데이터를 상세 카드 형태로 확인할 수 있습니다.
- 아직 PUT API 연동은 하지 않았으므로, 주석을 참고해 추후 업데이트 기능을 구현할 예정입니다.
- 필요하면 여기서 바로 삭제도 가능합니다.

## 5. 향후 TODO

- `/admin` 전체에 인증/권한 체크 추가 (예: x-admin-secret, OAuth 등)
- `POST/PUT/DELETE` 요청 시 관리자 키 검증 및 감사 로그 수집
- 수정 폼 완성 및 `PUT /api/issues/:id` 연동

> TODO 항목은 코드에도 주석으로 남겨두었습니다. 실제 운영 전에는 반드시 보안 절차를 도입해야 합니다.
